<div class="topbar" id="topbar">
  <a id="home_link" class="bar__link agent-3" href="/">Accueil</a>
  <a id="recipes_index_link" class="bar__link agent-3" href="/recipes">Recettes</a>
  <% unless request.path == '/' %>
    <form novalidate="novalidate" onsubmit="return searchQuery()" class="searchbox agent-3">
      <div role="search" class="search">
        <input type="search" name="query" required="required" class="search__input">
        <button type="reset" title="Annuler" class="button_svg button_svg__reset">
          <%= svg 'delete' %>
        </button>
      </div>
    </form>
  <% end %>

  <% if current_user.present? && current_user.admin? %>
    <div class="hamburger-menu agent-3">
      <div class="dropdown">
        <%= render 'shared/menu' %>
      </div>
    </div>
  <% end %>

  <div class="bar__line agent-2"></div>
  <div class="bar__title agent-1">
    <h1 class="bar__title--text">oishi.</h1>
  </div>
</div>

<script type="text/javascript">
  const reset = document.querySelector('.searchbox [type="reset"]');
  const input = document.querySelector('input');

  if (reset) {
    reset.addEventListener('click', function() {  this.parentNode.querySelector('input').focus();})
  }

  if (input) {
    input.addEventListener('focus', function() { reset.style.display = 'block'; })
    input.addEventListener('blur', function() { reset.style.display = 'none'; })
  }

  function searchQuery() {
    const query = document.querySelector('.searchbox input').value
    window.location = `${window.location.origin}/?query=${query}`
    return false
  }
</script>
