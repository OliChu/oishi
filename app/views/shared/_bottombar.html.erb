<div class="bottombar" id="bottombar">
  <form novalidate="novalidate" onsubmit="return searchQuery()" class="searchbox_bottom">
    <div role="search" class="search">
      <input type="search" name="query" required="required" class="search__input">
      <button type="reset" title="Annuler" class="button_svg button_svg__reset">
        <%= svg 'delete' %>
      </button>
    </div>
  </form>

  <a id="recipes_index_link" class="bar__link" href="/recipes">Recettes</a>

  <% if current_user.present? && current_user.admin? %>
    <div class="hamburger-menu agent-3">
      <div class="dropup">
        <%= render 'shared/menu' %>
      </div>
    </div>
  <% end %>

  <div class="bar__title">
    <a id="home_link" class="bar__link" href="/">
      <h1 class="bar__title--text">oishi.</h1>
    </a>
  </div>
</div>

<script type="text/javascript">
  const reset_bottom = document.querySelector('.searchbox_bottom [type="reset"]');
  const input_bottom = document.querySelector('input');

  if (reset_bottom) {
    reset_bottom.addEventListener('click', function() {  this.parentNode.querySelector('input').focus();})
  }

  if (input_bottom) {
    input_bottom.addEventListener('focus', function() { reset_bottom.style.display = 'block'; })
    input_bottom.addEventListener('blur', function() { reset_bottom.style.display = 'none'; })
  }

  function searchQuery() {
    const query = document.querySelector('.searchbox_bottom input').value
    window.location = `${window.location.origin}/?query=${query}`
    return false
  }
</script>
